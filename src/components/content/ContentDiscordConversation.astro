---
import GgSansFont from '@components/fonts/GgSansFont.astro'
import Link from '@components/Link.astro'
import { Icon } from 'astro-icon/components'

interface Props {
  src?: string
  title?: string
}

const {
  src = '/images/smpearth-chip-wilbur-msg.png',
  title = 'Discord Conversation',
} = Astro.props
---

<GgSansFont />

<section
  class='discord-conversation relative bg-neutral shadow-lg outline outline-neutral-content/75'
  style='margin-top: 2rem; margin-bottom: 2rem;'
  aria-label={`Discord conversation: ${title}`}
>
  <h2 id='conversation-title' class='sr-only'>{title}</h2>
  <Link
    href={src}
    class='menu tooltip tooltip-bottom tooltip-primary absolute bottom-4 right-4 text-accent-content'
    data-tip='View original source'
    underline={false}
    externalInNewTab={true}
    aria-label='View original source'
  >
    <Icon name='lucide:link' class='size-4' aria-hidden='true' />
    <span class='sr-only'>View original source</span>
  </Link>
  <div role='list' class='discord-messages'>
    <slot />
  </div>
</section>

<style>
  :global(.tooltip) {
    font-weight: normal !important;
    font-family: 'Inter', sans-serif !important;
  }

  :global(.tooltip:before) {
    font-weight: normal !important;
    font-family: 'Inter', sans-serif !important;
  }

  .discord-conversation {
    border-radius: 16px;
    padding: 1.5rem;
    margin-bottom: 1rem;
    font-family: 'gg-sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
    @apply prose text-base-content;
    position: relative;
    min-height: 100px;
  }

  .discord-conversation :global(.discord-message) {
    margin: -0.5rem -0.5rem 0.5rem -0.5rem;
    padding: 0.5rem;
    border-radius: 8px;
  }

  .discord-conversation :global(.discord-message:hover) {
    background-color: oklch(var(--nc) / 0.3);
  }

  .discord-conversation :global(.discord-message:last-child) {
    margin-bottom: -0.5rem;
  }

  .menu:hover {
    color: oklch(var(--p));
  }
</style>
